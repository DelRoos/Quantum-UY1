{% extends "bases.html" %}
{% load static %}

{% block title %}Accueil - {{ site_name }}{% endblock %}

{% block content %}
<style>
  /* Styles spécifiques pour la page article */
  .article-hero {
    padding-block-start: calc(var(--section-padding) + 60px);
    background-color: var(--bg-prussian-blue);
    padding-bottom: 3rem;
  }

  .article-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 2rem;
    margin-block: 2rem;
    align-items: center;
  }

  .author-card {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .author-avatar {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-circle);
    object-fit: cover;
  }

  .author-info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .author-name {
    color: var(--text-carolina-blue);
    font-size: var(--fontSize-6);
    font-weight: var(--weight-semiBold);
  }

  .author-role {
    color: var(--text-wild-blue-yonder);
    font-size: var(--fontSize-7);
  }

  .article-info {
    display: flex;
    gap: 1.5rem;
    color: var(--text-wild-blue-yonder);
    font-size: var(--fontSize-6);
  }

  .info-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .article-content {
    display: grid;
    grid-template-columns: 2.5fr 1fr;
    gap: 3rem;
    padding-block: 3rem;
  }

  .article-main {
    background-color: var(--bg-oxford-blue);
    padding: 2rem;
    border-radius: var(--radius-16);
    border: 1px solid var(--border-prussian-blue);
  }

  .article-image {
    margin-left: 18rem;
    border-radius: var(--radius-16);
    overflow: hidden;
    width: 400px;  /* Largeur fixe */
    height: 400px; /* Hauteur fixe */
    object-fit: cover; /* Pour garder le ratio d'aspect */
  }

  .article-image img {
    width: 100%;
    height: auto;
  }

  .article-text {
    color: var(--text-wild-blue-yonder);
    font-size: var(--fontSize-6);
    line-height: 1.8;
    margin-block: 1.5rem;
  }

  .article-section {
    margin-block: 3rem;
  }

  .section-title {
    color: var(--text-carolina-blue);
    font-size: var(--fontSize-3);
    margin-bottom: 1.5rem;
  }

  .quote-block {
    background-color: var(--bg-prussian-blue);
    padding: 2rem;
    border-radius: var(--radius-8);
    border-left: 4px solid var(--bg-carolina-blue);
    margin-block: 2rem;
  }

  .quote-text {
    color: var(--text-alice-blue);
    font-size: var(--fontSize-5);
    font-style: italic;
    margin-bottom: 1rem;
  }

  .quote-author {
    color: var(--text-carolina-blue);
    font-size: var(--fontSize-6);
    font-weight: var(--weight-semiBold);
  }

  .article-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
    margin-block: 2rem;
  }

  .tag-link {
    padding: 0.5rem 1rem;
    background-color: var(--bg-prussian-blue);
    color: var(--text-wild-blue-yonder);
    font-size: var(--fontSize-7);
    border-radius: var(--radius-pill);
    transition: all var(--transition-1);
  }

  .tag-link:hover {
    background-color: var(--bg-carolina-blue);
    color: var(--text-white);
  }

  .share-section {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-block: 3rem;
    padding: 1.5rem;
    background-color: var(--bg-prussian-blue);
    border-radius: var(--radius-8);
  }

  .share-title {
    color: var(--text-wild-blue-yonder);
    font-size: var(--fontSize-6);
  }

  .share-buttons {
    display: flex;
    gap: 1rem;
  }

  .share-btn {
    width: 40px;
    height: 40px;
    display: grid;
    place-items: center;
    background-color: var(--bg-oxford-blue);
    border-radius: var(--radius-circle);
    color: var(--text-wild-blue-yonder);
    transition: all var(--transition-1);
  }

  .share-btn:hover {
    background-color: var(--bg-carolina-blue);
    color: var(--text-white);
    transform: translateY(-2px);
  }

  .comments-section {
    margin-block: 3rem;
  }

  .comment-card {
    display: flex;
    gap: 1.5rem;
    padding: 1.5rem;
    background-color: var(--bg-prussian-blue);
    border-radius: var(--radius-8);
    margin-bottom: 1.5rem;
  }

  .comment-content {
    flex: 1;
  }

  .comment-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1rem;
  }

  .comment-text {
    color: var(--text-wild-blue-yonder);
    font-size: var(--fontSize-6);
    line-height: 1.6;
  }

  .comment-form {
    margin-top: 2rem;
  }

  .form-field {
    margin-bottom: 1.5rem;
  }

  .form-label {
    display: block;
    color: var(--text-wild-blue-yonder);
    font-size: var(--fontSize-6);
    margin-bottom: 0.5rem;
  }

  .form-input,
  .form-textarea {
    width: 100%;
    padding: 1rem;
    background-color: var(--bg-prussian-blue);
    border: 1px solid var(--border-prussian-blue);
    border-radius: var(--radius-8);
    color: var(--text-wild-blue-yonder);
    font-size: var(--fontSize-6);
  }

  .form-textarea {
    height: 150px;
    resize: vertical;
  }

  @media (max-width: 992px) {
    .article-content {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 768px) {
    .article-meta {
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }

    .comment-card {
      flex-direction: column;
    }
  }

  /* Navigation entre articles */
  .article-navigation {
    margin-top: 4rem;
    padding-top: 2rem;
    border-top: 1px solid var(--border-prussian-blue);
  }

  .nav-links {
    display: flex;
    justify-content: space-between;
    gap: 2rem;
  }

  .nav-link {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1.5rem;
    background-color: var(--bg-oxford-blue);
    border-radius: var(--radius-8);
    border: 1px solid var(--border-prussian-blue);
    transition: all var(--transition-1);
    flex: 1;
  }

  .nav-link:hover {
    background-color: var(--bg-prussian-blue);
    transform: translateY(-2px);
  }

  .nav-link.prev {
    text-align: left;
  }

  .nav-link.next {
    text-align: right;
    flex-direction: row-reverse;
  }

  .nav-label {
    color: var(--text-wild-blue-yonder);
    font-size: var(--fontSize-7);
    margin-bottom: 0.5rem;
  }

  .nav-title {
    color: var(--text-carolina-blue);
    font-size: var(--fontSize-6);
    font-weight: var(--weight-semiBold);
  }

  @media (max-width: 768px) {
    .nav-links {
      flex-direction: column;
    }

    .nav-link {
      width: 100%;
    }

    .nav-link.next {
      justify-content: flex-start;
      flex-direction: row;
    }
  }

  /* Ajustements pour la newsletter dans la sidebar */
  .newsletter-form {
    margin-top: 1.5rem;
  }

  .newsletter-form .form-input {
    margin-bottom: 1rem;
  }

  /* Ajustements pour la liste des tags */
  .tag-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }


/* Styles généraux de la sidebar */
.sidebar {
  position: sticky;
  top: 2rem;
}

.sidebar-card {
  background-color: var(--bg-oxford-blue);
  border-radius: var(--radius-16);
  border: 1px solid var(--border-prussian-blue);
  padding: 2rem;
  margin-bottom: 2rem;
  transition: transform var(--transition-1);
}

.sidebar-card:hover {
  transform: translateY(-5px);
}

.sidebar-title {
  color: var(--text-carolina-blue);
  font-size: var(--fontSize-3);
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid var(--border-prussian-blue);
  position: relative;
}

.sidebar-title::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: -2px;
  width: 50px;
  height: 2px;
  background-color: var(--bg-carolina-blue);
}

/* Profil de l'auteur amélioré */
.author-profile {
  text-align: center;
  padding: 1rem;
}

.author-profile .author-avatar {
  width: 120px;
  height: 120px;
  border-radius: var(--radius-circle);
  margin: 0 auto 1.5rem;
  border: 4px solid var(--bg-carolina-blue);
  padding: 4px;
}

.author-profile .author-name {
  font-size: var(--fontSize-4);
  margin-bottom: 0.5rem;
}

.author-profile .author-role {
  color: var(--text-wild-blue-yonder);
  font-size: var(--fontSize-6);
  margin-bottom: 1rem;
}

.author-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  padding: 1rem 0;
  border-top: 1px solid var(--border-prussian-blue);
  border-bottom: 1px solid var(--border-prussian-blue);
  margin: 1.5rem 0;
}

.stat-item {
  text-align: center;
}

.stat-value {
  color: var(--text-carolina-blue);
  font-size: var(--fontSize-3);
  font-weight: var(--weight-bold);
  margin-bottom: 0.25rem;
}

.stat-label {
  color: var(--text-wild-blue-yonder);
  font-size: var(--fontSize-7);
}

.author-socials {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-top: 1.5rem;
}


/* Articles similaires améliorés */
.similar-post {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  padding: 1rem 0;
  border-bottom: 1px solid var(--border-prussian-blue);
}

.similar-post:last-child {
  border-bottom: none;
  padding-bottom: 0;
}

.similar-post-img {
  width: 100px;
  height: 100px;
  border-radius: var(--radius-8);
  overflow: hidden;
}

.similar-post-img img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform var(--transition-2);
}

.similar-post:hover .similar-post-img img {
  transform: scale(1.1);
}

.similar-post-content {
  flex: 1;
}

.similar-post-title {
  font-size: var(--fontSize-6);
  color: var(--text-alice-blue);
  font-weight: var(--weight-semiBold);
  margin-bottom: 0.5rem;
  transition: color var(--transition-1);
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.similar-post-title:hover {
  color: var(--text-carolina-blue);
}

.similar-post-meta {
  display: flex;
  gap: 1rem;
  color: var(--text-wild-blue-yonder);
  font-size: var(--fontSize-7);
}

/* Newsletter améliorée */
.newsletter-card {
  text-align: center;
  background: linear-gradient(145deg, var(--bg-prussian-blue), var(--bg-oxford-blue));
}

.newsletter-card .sidebar-title {
  text-align: center;
}

.newsletter-card .sidebar-title::after {
  left: 50%;
  transform: translateX(-50%);
}

.newsletter-text {
  color: var(--text-wild-blue-yonder);
  font-size: var(--fontSize-6);
  margin-bottom: 2rem;
}

.newsletter-form .form-input {
  background-color: var(--bg-oxford-blue-2);
  border: 1px solid var(--border-prussian-blue);
  border-radius: var(--radius-pill);
  padding: 1rem 1.5rem;
  margin-bottom: 1rem;
  text-align: center;
  transition: all var(--transition-1);
}

.newsletter-form .form-input:focus {
  border-color: var(--bg-carolina-blue);
  box-shadow: 0 0 0 2px rgba(10, 165, 234, 0.1);
}

.newsletter-form .btn {
  width: 100%;
  border-radius: var(--radius-pill);
}

/* Tags améliorés */
.sidebar-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
}

.tag-link {
  padding: 0.5rem 1rem;
  background-color: var(--bg-prussian-blue);
  color: var(--text-wild-blue-yonder);
  font-size: var(--fontSize-7);
  border-radius: var(--radius-pill);
  transition: all var(--transition-1);
}

.tag-link:hover {
  background-color: var(--bg-carolina-blue);
  color: var(--text-white);
  transform: translateY(-3px);
}
</style>

  <main>
    <!-- Article Hero -->
    <section class="article-hero">
      <div class="container">
        <h1 class="headline-1">
          {{ post.title }}
        </h1>

        <div class="article-meta">
          <div class="author-card">
            <img src="{{ author_profile.photo.url }}" alt=" " class="author-avatar">
            <div class="author-info">
              <span class="author-name">Published  by {{ author_profile.title.name }} {{ author_profile.user.first_name }} {{ author_profile.user.last_name }}</span>
              <span class="author-role">
                <span class="info-item">
                  <ion-icon name="calendar-outline"></ion-icon>
                  <span>{{ post.publish }}</span>
                </span>
            </div>
          </div>

          <div class="article-info">
            <span class="info-item">
              <ion-icon name="chatbubble-outline"></ion-icon>
              <span>{% with comments.count as total_comments %}
               
                    {{ total_comments }}{{ total_comments|pluralize }}
                
            {% endwith %} Commentaire(s)</span>
            </span>
          </div>
        </div>
      </div>
    </section>

    <!-- Article Content -->
    <div class="section">
      <div class="container">
        <div class="article-content">
          <!-- Main Content -->
          <article class="article-main">
            <figure class="article-image">
              <img src="{{ post.photo.url }}" alt="Informatique Quantique" loading="lazy">
            </figure>

            <div class="article-section">
              <p class="article-text">
                <!-- {{ post.body|linebreaks }} -->
              </p>

              <blockquote class="quote-block">
                <p class="quote-text">
                  {{ post.body|linebreaks }}
                </p>
              </blockquote>
            </div>

            <!-- Tags -->
            
            <div class="article-tags">
              
              {% for tag in post.tags.all %}
                <a class="tag-link" href="{% url "blog:post_list_by_tag" tag.slug %}">
              {{ tag.name }}
                </a>
              {% endfor %}

            </div>

            <!-- Share Section -->
            <div class="share-section">
              <span class="share-title">Partager l'article :</span>
              <div class="share-buttons">
                <a href="#" class="share-btn" aria-label="Share on Twitter">
                  <ion-icon name="logo-twitter"></ion-icon>
                </a>
                <a href="#" class="share-btn" aria-label="Share on LinkedIn">
                  <ion-icon name="logo-linkedin"></ion-icon>
                </a>
                <a href="#" class="share-btn" aria-label="Share on Facebook">
                  <ion-icon name="logo-facebook"></ion-icon>
                </a>
              </div>
            </div>

            <!-- Comments Section -->
            <section class="comments-section">
              <h2 class="section-title">Commentaires ( {% with comments.count as total_comments %}
               
                {{ total_comments }} comment{{ total_comments|pluralize }}
            
        {% endwith %} )</h2>

        {% for comment in comments %}
              <div class="comment-card">
                <!-- <img src="/api/placeholder/48/48" alt="User" class="author-avatar"> -->
                <div class="comment-content">
                  <div class="comment-header">
                    <div class="author-info">
                      <span class="author-name">{{ comment.name }}</span>
                      <span class="author-role">{{ comment.created }}</span>
                    </div>
                  </div>
                  <p class="comment-text">
                    {{ comment.body|linebreaks }}
                  </p>
                </div>
              </div>
        {% empty %}
            <p>Ecrire un commentaire...</p>
        {% endfor %}

              <!-- Comment Form -->
              <form class="comment-form" method="post">
                {% csrf_token %}
                <h3 class="section-title">Laisser un commentaire</h3>
                
                <div class="form-field">
                    <label for="{{ form.name.id_for_label }}" class="form-label">Nom</label>
                    {{ form.name }}
                    {{ form.name.errors }}
                </div>

                <div class="form-field">
                    <label for="{{ form.email.id_for_label }}" class="form-label">Email</label>
                    {{ form.email }}
                    {{ form.email.errors }}
                </div>

                <div class="form-field">
                    <label for="{{ form.body.id_for_label }}" class="form-label">Commentaire</label>
                    {{ form.body }}
                    {{ form.body.errors }}
                </div>

                <button type="submit" class="btn btn-primary">Publier le commentaire</button>
              </form>
            </section>
          </article>



<aside class="sidebar">
    <!-- Profil de l'auteur -->
    <div class="sidebar-card">
      <h3 class="sidebar-title">À propos de l'auteur</h3>
      <div class="author-profile">
        <img src="{{ author_profile.photo.url }}" alt=" " class="author-avatar">
        <h4 class="author-name">{{ author_profile.title.name }} {{ author_profile.user.first_name }} {{ author_profile.user.last_name }}</h4>
        <p class="author-role">Spécialisé en {% for expertise in author_profile.expertise.all %}
          {{ expertise.name }}{% if not forloop.last %}, {% endif %}
      {% endfor %}</p>
        
        <!-- <div class="author-stats">
          <div class="stat-item">
            <div class="stat-value">15</div>
            <div class="stat-label">Articles</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">25</div>
            <div class="stat-label">Publications</div>
          </div>
        </div> -->
  
        <p class="article-text">
          
        </p>
  
        <div class="author-socials">
          <a href="#" class="social-link">
            <ion-icon name="logo-twitter"></ion-icon>
          </a>
          <a href="#" class="social-link">
            <ion-icon name="logo-linkedin"></ion-icon>
          </a>
          <a href="#" class="social-link">
            <ion-icon name="logo-github"></ion-icon>
          </a>
        </div>
      </div>
    </div>
  
    <!-- Article du meme auteur -->
    <div class="sidebar-card">
      <h3 class="sidebar-title">Article du meme auteur</h3>
      {% if posts_author %}
      {% for post in posts_author %}
      <article class="similar-post">
        <figure class="similar-post-img">
          <img src="{{ post.photo.url }}" alt="Article similaire" loading="lazy">
        </figure>
        <div class="similar-post-content">
          <h4>
            <a href="{% url 'blog:post_detail' post.id %}" class="similar-post-title">
              {{ post.title }}
            </a>
          </h4>
          <div class="similar-post-meta">
            <span>
              <ion-icon name="calendar-outline"></ion-icon>
              {{ post.publish }}
            </span>
          </div>
        </div>
      </article>
      {% endfor %}
      {% else %}
          <p>Aucun article trouvé pour cet auteur.</p>
      {% endif %}
    </div>
  
    <!-- Article similaire -->
    <div class="sidebar-card">
      <h3 class="sidebar-title">Article similaire</h3>
      {% for post in similar_posts %}
      <article class="similar-post">
        <figure class="similar-post-img">
          <img src="{{ post.photo.url }}" alt="Article similaire" loading="lazy">
        </figure>
        <div class="similar-post-content">
          <h4>
            <a href="{% url 'blog:post_detail' post.id %}" class="similar-post-title">
              {{ post.title }}
            </a>
          </h4>
          <div class="similar-post-meta">
            <span>
              <ion-icon name="calendar-outline"></ion-icon>
              {{ post.publish }}
            </span>
          </div>
        </div>
      </article>
      {% empty %}
        There are no similar posts yet.
      {% endfor %}
    </div>
  </aside>
          </div>
  
        </div>
      </div>
    </main>

   

{% endblock %}